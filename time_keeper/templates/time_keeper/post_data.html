{% extends 'time_keeper/base.html' %}
{% block content %}
{% load static %}

	<script type="text/javascript">
		$(function() {

			var test = [];
			var i = 0;
			var data_json; 

			$("#submit_data").click(function(){
				alert("Data will be saved to main DB.");
			});

			dbPromise.then(function(db) {
					  var tx = db.transaction('records', 'readonly');
					  var recordsStore = tx.objectStore('records');
					  return recordsStore.openCursor();
					}).then(function logItems(cursor) {
					  if (!cursor) {
					    return;
					  }
					  latest_key = cursor.key;
					  console.log(cursor.value);
					  test[i] = cursor.value;
					  i = i + 1;
					  return cursor.continue().then(logItems);
					}).then(function(){
						data_json = JSON.stringify(test);
						inputVal = document.getElementsByName('data')[0];
						inputVal.value = data_json;
						$("#id_data").hide();
					});
		});
	</script>
	<div style="margin-left:20px">
		<br><br><br><br><br><br>
		<form action='' method='POST'>
			<input type="text" name="data" required id="id_data">
			{% csrf_token %}
			<input type='submit' id='submit_data' value="Save Data">
		</form>
	</div>

</html>

{% endblock %}